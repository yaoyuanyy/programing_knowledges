= æŸ¥çœ‹è¿œç¨‹javaæœåŠ¡çš„system propertiesçš„æ‰€æœ‰æ–¹å¼æ–¹æ³•
:toc: left
:toc-title: ç›®å½•
:tip-caption: ğŸ’¡
:note-caption: â„¹ï¸
:important-caption: â—
:caution-caption: ğŸ”¥
:warning-caption: âš ï¸
// :tip-caption: :bulb:
// :note-caption: :information_source:
// :important-caption: :heavy_exclamation_mark:	
// :caution-caption: :fire:
// :warning-caption: :warning:
:icons: font

Doc writer yaoyihao1@gmail.com


== èƒŒæ™¯
ä»Šå¤©æ¥åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œpdfæ–‡ä»¶åŠ æ°´å°ï¼Œç»è¿‡ä¸€ç•ªè°ƒç ”å®ç°äº†ï¼Œä½†æœ‰ä¸ªç»†èŠ‚ï¼šéœ€è¦å°†åŠ æ°´å°çš„å­—èŠ‚æµæŒä¹…åŒ–åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œç„¶åå†è¯»å–è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°äº‘ä¸Šã€‚å¤§å®¶éƒ½çŸ¥é“ï¼Œçº¿ä¸Šçš„æœºå™¨ç£ç›˜è·¯å¾„éƒ½æ˜¯éœ€è¦æƒé™æ‰èƒ½åˆ›å»ºæ–‡ä»¶çš„ã€‚æ‰€ä»¥ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œéœ€è¦ç¡®è®¤çº¿ä¸Šçš„java.io.tmpdiræŒ‡å®šçš„è·¯å¾„æ˜¯å¦éœ€è¦æƒé™è®¿é—®ï¼Œæˆ‘éœ€è¦æŠŠjava.io.tmpdirçš„è·¯å¾„å‘Šè¯‰SREåŒäº‹ï¼Œä»è€Œç¡®è®¤æ˜¯å¦æœ‰æƒé™ã€‚ä½†é—®é¢˜æ˜¯æˆ‘éœ€è¦çŸ¥é“java.io.tmpdirçš„å€¼ã€‚é‚£ä¹ˆï¼Œé—®é¢˜æ¥äº†ï¼Œæˆ‘æ€ä¹ˆçŸ¥é“å‘¢

[NOTE]
å½“ç„¶ï¼Œä¸èƒ½åœ¨é¡¹ç›®ä¸­ç°åŠ ä»£ç é‡å¯æœåŠ¡ï¼Œé‚£æ ·æˆæœ¬å¤ªé«˜äº†ï¼Œä¹Ÿä¸ä¼˜é›…

è¿™ç¯‡æ–‡ç« ä¼šç»™å‡ºé—®é¢˜çš„ç­”æ¡ˆï¼Œå¹¶ä¸”ä¼šå±•ç¤ºå¾ˆå¤šçš„æ–¹å¼æ–¹æ³•ï¼Œä»¥ä¾¿å®é™…å·¥ä½œä¸­å¸®åŠ©ä½ é€‰æ‹©é€‚åˆä½ çš„é‚£ä¸ªã€‚æœ¬ç¯‡é€šè¿‡ä»¥java.io.tmpdirè¿™ä¸ªjavaç³»ç»Ÿå˜é‡(system properties)ä¸ºä¾‹ï¼Œæ­ç¤ºæŸ¥çœ‹javaç³»ç»Ÿå˜é‡(system properties)çš„æ‰€æœ‰æ–¹å¼æ–¹æ³•

> æœ¬æ–‡åŠ›æ±‚ä¸“æ³¨å’Œç²¾ç®€ï¼Œå¸Œæœ›ä½ æœ‰æ‰€æ”¶è·å’Œæƒ³æ³•

== æ­£æ–‡

=== method 1 - spring boot actuator/envç«¯ç‚¹
å› ä¸ºæˆ‘ä»¬çš„æŠ€æœ¯æ ˆæ˜¯spring boot2ï¼Œæ‰€ä»¥æˆ‘ç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„æ˜¯é€šè¿‡/actuatoc/envæŸ¥çœ‹ã€‚å¯åŠ¨æœåŠ¡åæµè§ˆå™¨è®¿é—®ip:port/actuator/envã€‚å¦‚æˆ‘çš„æœåŠ¡http://localhost:2372/actuator/env

image::https://raw.githubusercontent.com/yaoyuanyy/MarkdownPhotos/master/img/20201021142056.png[20201021142056]

[NOTE]
å¾ˆå¤šå¤§å‚é‡Œï¼Œä¸ºäº†å®‰å…¨æ€§ï¼Œè¿ç»´äººå‘˜ä¼šç¦æ‰æˆ–åŠ æƒé™actuatorçš„ç«¯ç‚¹è®¿é—®ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æ— æ³•ä½¿ç”¨è¿™ç§æ–¹å¼äº†ã€‚

=== method 2 - jinfo -sysprops

å¤§å®¶éƒ½çŸ¥é“ï¼Œjavaæœ¬èº«æš´éœ²ç»™æˆ‘ä»¬å‡ å¤§å‘½ä»¤ï¼Œæ˜¯çš„ï¼Œé€šè¿‡å‘½ä»¤ä¹Ÿå¯ä»¥æŸ¥çœ‹javaç³»ç»Ÿå‚æ•°ï¼Œä½¿ç”¨jinfoå‘½ä»¤ã€‚jinfo -sysprops pidã€‚
å¦‚ä¸‹

----
[root@test code]= jinfo -sysprops 1
Attaching to process ID 1, please wait...
Debugger attached successfully.
Server compiler detected.
JVM version is 25.181-b13
java.vendor = Oracle Corporation
sun.java.launcher = SUN_STANDARD
catalina.base = /tmp/tomcat.7396898948000000000.8080
java.io.tmpdir = /tmp
  ...
----

[NOTE]
åŒæ ·ï¼Œè¿™ç§æ–¹å¼ä¹Ÿé¢ä¸´åŒæ ·çš„é—®é¢˜ï¼šå¾ˆå¤šå¤§å‚é‡Œï¼Œä¸ºäº†å®‰å…¨æ€§ï¼Œè¿ç»´äººå‘˜ä¼šç¦æ‰æˆ–åŠ æƒé™actuatorçš„ç«¯ç‚¹è®¿é—®ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±æ— æ³•ä½¿ç”¨è¿™ç§æ–¹å¼äº†ã€‚

æ“ä½œæ—¶ä¼šæŠ¥ä¸‹é¢çš„é”™è¯¯

----
[01@online 20201021]$ jinfo  13900                                                             
Attaching to process ID 13900, please wait...
Error attaching to process: sun.jvm.hotspot.debugger.DebuggerException: cannot open binary file
sun.jvm.hotspot.debugger.DebuggerException: sun.jvm.hotspot.debugger.DebuggerException: cannot open binary file
  at sun.jvm.hotspot.debugger.linux.LinuxDebuggerLocal$LinuxDebuggerLocalWorkerThread.execute(LinuxDebuggerLocal.java:163)
----


=== method 3 - jvisualvm or VisualVM

æˆ‘ä»¬çŸ¥é“ï¼Œjavaä¹Ÿæš´éœ²ç»™æˆ‘ä»¬ä¸€äº›å¯è§†åŒ–ç›‘æ§çš„å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥è¿œç¨‹è¿æ¥ï¼Œä»è€ŒæŸ¥çœ‹javaç³»ç»Ÿå±æ€§ã€‚å¦‚jvisualvmï¼ŒVisualVMï¼Œjconsoleï¼Œjmcã€‚ä½†æœ‰ä¸ªå‰æï¼Œjava -jarå¯åŠ¨å‘½ä»¤é‡Œéœ€è¦é…ç½®jmxå‚æ•°

----
-Dcom.sun.management.jmxremote 
-Dcom.sun.management.jmxremote.port=8081 
-Dcom.sun.management.jmxremote.authenticate=false 
-Dcom.sun.management.jmxremote.ssl=false
----
æˆ‘ä»¬çœ‹ä¸‹jvisualvmçš„æ•ˆæœ

image::https://raw.githubusercontent.com/yaoyuanyy/MarkdownPhotos/master/img/20201021150032.png[20201021150032]

image::https://raw.githubusercontent.com/yaoyuanyy/MarkdownPhotos/master/img/20201021150401.png[20201021150401]

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œè¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥æ–¹ä¾¿çš„çœ‹åˆ°javaç³»ç»Ÿå‚æ•°ã€‚ä½†æ˜¯éœ€è¦æš´éœ²jmxé…ç½®ï¼Œæ‰€ä»¥ï¼Œå‡å¦‚java -jaræ²¡æœ‰æš´éœ²jmxå‚æ•°ï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼å°±ä¸èƒ½ä½¿ç”¨äº†ã€‚

=== method 4 - java -XshowSettings:category
è¿™ç§æ–¹å¼ï¼Œä¹Ÿæ˜¯é€šè¿‡javaå‘½ä»¤ï¼Œæ˜¯javaçš„-Xå‘½ä»¤ï¼Œ-Xå‘½ä»¤æ˜¯javaéæ ‡å‡†çš„å‘½ä»¤ï¼Œä½†ä¹Ÿå¾ˆç¨³å®šã€‚æ›´å…³é”®çš„æ˜¯è¿™ç§æ–¹å¼æ˜¯æ²¡æœ‰å±€é™çš„ã€‚è¿ç»´ä¸€èˆ¬ä¸ä¼šåŠ æƒé™

`-XshowSettings:category`

Possible category arguments for this option include the following:

----
all
Shows all categories of settings. This is the default value.

locale
Shows settings related to locale.

properties
Shows settings related to system properties.

vm
Shows the settings of the JVM.
----

æ•ˆæœå¦‚ä¸‹ï¼š

----
[root@test code]= java -XshowSettings:all -version
VM settings:
    Max. Heap Size (Estimated): 10.93G
    Ergonomics Machine Class: server
    Using VM: Java HotSpot(TM) 64-Bit Server VM

Property settings:
    awt.toolkit = sun.awt.X11.XToolkit
    file.encoding = UTF-8
    file.encoding.pkg = sun.io
    file.separator = /
    java.io.tmpdir = /tmp
    ...
----


== it`s time to summary
æœ¬æ–‡ä»‹ç»äº†å››ç§æŸ¥çœ‹javaç³»ç»Ÿå‚æ•°çš„æ–¹å¼

1. spring boot actuator/envç«¯ç‚¹
2. jinfo -sysprops
3. jvisualvm or VisualVM
4. java -XshowSettings:all


ç¬¬ä¸€ã€äºŒç§æ–¹å¼è¿ç»´ä¾§ä¼šç¦æ‰æˆ–åŠ æƒé™ï¼Œå¯¼è‡´ä¸èƒ½ä½¿ç”¨ï¼Œæˆ–ä½¿ç”¨å¤æ‚ï¼›ç¬¬ä¸‰ç§æ–¹å¼éœ€è¦java -jaré…ç½®jmxä¿¡æ¯ï¼›ç¬¬å››ç§æ–¹å¼ç›®å‰æ²¡å‘ç°çº¦æŸæ€§ã€‚è¿™å››ç§æ–¹å¼éƒ½æ˜¯å¾ˆæ–¹ä¾¿çš„

è¿˜æœ‰å…¶ä»–çš„æ–¹å¼ï¼Œå¦‚arthasã€ç¼–å†™ä»£ç é‡å¯æœåŠ¡ç­‰ã€‚ä¸€åˆ‡ä»¥æ–¹ä¾¿çš„è§£å†³é—®é¢˜ä¸ºä¸»
